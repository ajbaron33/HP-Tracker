<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Monster HP Tracker</title>
<style>
  body{background:#0b0b0c;color:#e8eaed;font:16px/1.4 -apple-system,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;padding:20px;}
  .card{background:#131316;border:1px solid #2a2a31;border-radius:14px;padding:12px;}
  input,button,select{padding:8px;margin:4px;border-radius:8px;border:1px solid #2a2a31;background:#1f1f24;color:#e8eaed;}
  input[type=number]::-webkit-outer-spin-button,
  input[type=number]::-webkit-inner-spin-button{ -webkit-appearance: none; margin: 0; }
  .banner{width:100%;height:auto;max-height:300px;object-fit:cover;border-radius:14px;margin-bottom:20px;}
  .thumbnail-wrapper{position:relative;display:inline-block;}
  .thumbnail-x{
    position:absolute;
    top:0;right:0;
    color:#ff4d4d;
    font-weight:bold;
    background:#131316;
    border-radius:50%;
    padding:0 4px;
    opacity:0.6;
    transition:opacity 0.2s ease;
    pointer-events:none; /* makes sure it can’t be clicked */
  }
  .thumbnail-wrapper:hover .thumbnail-x{
    opacity:1;
  }
</style>
</head>
<body>
  <!-- Banner image -->
  <img src="./IMG_9858.jpeg" alt="Banner" class="banner">

  <h1>Monster HP Tracker</h1>
  <div>
    <input id="monsterName" placeholder="Monster name" />
    <input id="monsterAC" type="number" placeholder="AC" />
    <input id="monsterHP" type="number" placeholder="HP" />
    <input id="monsterImage" type="file" accept="image/*" />
    <button onclick="addMonster()">Add</button>
  </div>
  <div id="monsters"></div>

<script>
let monsters = [];
const defaultImage = '';

function genId(){return '_' + Math.random().toString(36).substr(2,9);}

function save(){
  localStorage.setItem('monsters', JSON.stringify(monsters));
}

function load(){
  monsters = JSON.parse(localStorage.getItem('monsters')||'[]');
}

function render(){
  const div=document.getElementById('monsters');
  div.innerHTML='';
  monsters.forEach(m=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <strong>${m.name}</strong> (AC ${m.ac})
      <div>HP: ${m.hp}</div>
      <div class="thumbnail-wrapper">
        <img src="${m.image||defaultImage}" alt="" style="max-width:100px;border-radius:8px;">
        <span class="thumbnail-x">✖</span>
      </div>
      <button onclick="removeMonster('${m.id}')">Remove</button>
      <button onclick="damage('${m.id}')">Damage</button>
      <button onclick="heal('${m.id}')">Heal</button>
      <button onclick="duplicateMonster('${m.id}')">Duplicate</button>
    `;
    div.appendChild(card);
  });
}

function addMonster(){
  const name=document.getElementById('monsterName').value.trim();
  const ac=parseInt(document.getElementById('monsterAC').value);
  const hp=parseInt(document.getElementById('monsterHP').value);
  const file=document.getElementById('monsterImage').files[0];
  if(!name) return;
  const reader=new FileReader();
  reader.onload=function(e){
    const imgData=e.target.result;
    monsters.push({id:genId(),name,ac,hp,image:imgData});
    save();render();
  }
  if(file){reader.readAsDataURL(file);}else{
    monsters.push({id:genId(),name,ac,hp,image:defaultImage});
    save();render();
  }
}

function damage(id){
  const m=monsters.find(x=>x.id===id);if(!m) return;
  const amt=parseInt(prompt('Damage amount?')||0);
  m.hp-=amt;
  save();render();
}

function heal(id){
  const m=monsters.find(x=>x.id===id);if(!m) return;
  const amt=parseInt(prompt('Heal amount?')||0);
  m.hp+=amt;
  save();render();
}

function removeMonster(id){
  monsters=monsters.filter(x=>x.id!==id);
  save();render();
}

function nextDuplicateName(name){
  const match=name.match(/^(.*?)(?: copy (\d+))?$/);
  if(!match) return name+" copy 1";
  let base=match[1].trim();
  let num=match[2]?parseInt(match[2]):0;
  num++;
  return base+" copy "+num;
}

function duplicateMonster(id){
  const m = monsters.find(x=>x.id===id); 
  if(!m) return;

  const dup = { 
    ...m, 
    id: genId(), 
    name: nextDuplicateName(m.name),
    image: m.image || defaultImage
  };

  monsters.push(dup);
  save(); 
  render();
}

load();
render();
</script>
</body>
</html>
